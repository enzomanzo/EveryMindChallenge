<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de Usuário</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="perfil.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img class="logo" src="/images/mountain logo.png" alt="">
                Blizzard
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-link" aria-current="page" href="/candidato/principal/vaga/vagas.html">Vagas</a>
                    <a class="nav-link active" href="/candidato/principal/perfil/perfil.html">Perfil</a>
                    <a class="nav-link" href="/candidato/login.html">Sair</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mt-5">
        <section class="profile-card">
            <div class="profile-image">
                <img src="/images/perfil.png" alt="Foto de perfil">
            </div>
            <h2 class="mt-3">Nome do Usuário</h2>
            <div class="user-details">
                <p>Email: usuario@email.com</p>
                <p>Telefone: (11) 1234-5678</p>
            </div>
            <button class="edit-btn" onclick="redirectToEditProfile()">Editar Perfil</button>
        </section>
        <section class="info-section mt-5">
            <h3 class="info-title">Vagas Aplicadas</h3>
            <div class="info-count">5</div>
        </section>
        <section class="actions-section mt-5">
            <h3>Informações Gerais</h3>
            <div class="actions-list">
                <div style="max-width: 400px; margin: 0 auto;">
                    <button class="btn mt-3 btn-block" onclick="redirectToGeneralInformations()"
                        style="background-color: rgba(42, 133, 194, 0.836); border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                        Informações Pessoais <i class="fas fa-arrow-right" style="margin-left: auto;"></i>
                    </button>
                    <button class="btn btn mt-3 btn-block" onclick="redirectToSkills()"
                        style="background-color: rgba(42, 133, 194, 0.836); border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);"">
                        Competências <i class="fas fa-arrow-right" style="margin-left: auto;"></i>
                    </button>
                    <button class="btn btn mt-3 btn-block" onclick="redirectToCourses()"
                        style="background-color: rgba(42, 133, 194, 0.836); border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);"">
                        Cursos Realizados <i class="fas fa-arrow-right" style="margin-left: auto;"></i>
                    </button>
                    <button class="btn btn mt-3 btn-block" onclick="redirectToEducation()"
                        style="background-color: rgba(42, 133, 194, 0.836); border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);"">
                        Educação <i class="fas fa-arrow-right" style="margin-left: auto;"></i>
                    </button>
                    <button class="btn btn mt-3 btn-block" onclick="redirectToExperience()"
                        style="background-color: rgba(42, 133, 194, 0.836); border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);"">
                        Experiência de Trabalho <i class="fas fa-arrow-right" style="margin-left: auto;"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Seus scripts de redirecionamento -->
        <script>
            function redirectToEditProfile() {
                window.location.href = "editarPerfil/editarPerfil.html";
            }

            function redirectToGeneralInformations() {
                window.location.href = "/candidato/principal/perfil/editarPerfil/editarinformacoes.html";
            }

            function redirectToSkills() {
                window.location.href = "/candidato/principal/perfil/editarPerfil/editarcompetencia.html";
            }

            function redirectToCourses() {
                window.location.href = "/candidato/principal/perfil/editarPerfil/editarcursos.html";
            }

            function redirectToEducation() {
                window.location.href = "/candidato/principal/perfil/editarPerfil/editarescolaridade.html";
            }

            function redirectToExperience() {
                window.location.href = "/candidato/principal/perfil/editarPerfil/editarexperiencia.html";
            }
        </script>

        <!-- Script para popular os campos do usuário -->
        <script>
            window.onload = function () {
                // Recupere o personId do localStorage
                const personId = localStorage.getItem('personId');

                // Se personId não existe, retorne
                if (!personId) {
                    console.error('personId não encontrado no localStorage');
                    return;
                }

                // Endpoint da API
                const apiURL = `http://localhost:8080/mnt_job_vacancies/v1/person/${personId}`;

                // Faça uma requisição GET ao endpoint
                fetch(apiURL)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Erro na resposta da rede');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Popule os campos do HTML com os dados obtidos

                        document.querySelector('.profile-card h2').innerText = data.name;
                        const userDetails = document.querySelector('.user-details');
                        userDetails.querySelector('p:first-child').innerText = `Email: ${data.email}`;
                        userDetails.querySelector('p:last-child').innerText = `Telefone: ${data.phoneNumber}`;
                        document.querySelector('.info-section .info-count').innerText = data.appliedJobsCount;

                    })
                    .catch(error => {
                        console.error('Houve um problema com a operação fetch: ', error.message);
                    });
            }
        </script>
    </body>
</html>
